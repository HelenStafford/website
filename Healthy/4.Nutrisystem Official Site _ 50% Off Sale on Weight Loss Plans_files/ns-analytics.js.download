function generateObj(f,a){var e={};if(typeof f!=="undefined"){e=JSON.parse(JSON.stringify(f));for(prop in a){var c=e.hasOwnProperty(prop);if(c){var b=a[prop];for(var d=0;d<b.length;d++){delete e[prop][b[d]]}}}}return e}editNsLayer={switchEmptyValues:function(){var b=nsLayer.profile;var e=["pageFlowId","retentionCampaignId"];var d={pageFlowId:"no_test#",retentionCampaignId:"none"};for(var a=0;a<e.length;a++){var c=b[e[a]];if(c.length==0){gtm_consoleLog("set value: "+d[e[a]]+" for attribute: "+e[a]);b[e[a]]=d[e[a]]}}},setStatus:function(){var a=["PNO","Past Customer","On Program"];var b=a[nsLayer.profile.nsUserRoleValue];if(nsLayer.profile.nsUserRoleValue==0){b=b+"-"+nsLayer.profile.profileRole}nsLayer.profile.userType=b},addData:function(c,a,b){if(typeof nsLayer[c]=="undefined"){nsLayer[c]={}}nsLayer[c][a]=b},setWeightRange:function(){var a=[0,20,40,60,80,100,120,140,160,180,200,220,240,260,280,300,320,340,360,380,400,420,440,460,480,500,520,540,560,580];var b=["0.00-19.99","20.00-39.99","40.00-59.99","60.00-79.99","80.00-99.99","100.00-119.99","120.00-139.99","140.00-159.99","160.00-179.99","180.00-199.99","200.00-219.99","220.00-239.99","240.00-259.99","260.00-279.99","280.00-299.99","300.00-319.99","320.00-339.99","340.00-359.99","360.00-379.99","380.00-399.99","400.00-419.99","420.00-439.99","440.00-459.99","460.00-479.99","480.00-499.99","500.00-519.99","520.00-539.99","540.00-559.99","560.00-579.99","580.00-599.99"];var c;var d;if(!nsLayer.profile.userCurrentWeight==""){for(i=0;i<a.length;i++){if(a[i]<=nsLayer.profile.userCurrentWeight){c=a[i];d=i}}nsLayer.profile.weightRange=b[d]}else{nsLayer.profile.weightRange=""}},setAgeRange:function(){var a=[0,6,11,16,21,26,31,36,41,46,51,56,61,66,71,76,81,86,91,96];var b=["0-5","6-10","11-15","16-20","21-25","26-30","31-35","36-40","41-45","46-50","51-55","56-60","61-65","66-70","71-75","76-80","81-85","86-90","91-95","96-100"];var c;var d;if(!nsLayer.profile.userAge==""){for(i=0;i<a.length;i++){if(a[i]<=nsLayer.profile.userAge){c=a[i];d=i}}nsLayer.profile.ageRange=b[d]}else{nsLayer.profile.ageRange=""}}};editNsLayer.setWeightRange();editNsLayer.setAgeRange();editNsLayer.setStatus();editNsLayer.switchEmptyValues();window.addEventListener("load",function(){gtm_consoleLog("*** Start push omniture to GTM ***");if(typeof dataLayer!=="undefined"){dataLayer.push({event:"dataLayerReady"})}gtm_consoleLog("*** End push omniture to GTM ***")});GTMRestrictProps={profile:["firstName","lastName"]};preDataLayer=generateObj(nsLayer,GTMRestrictProps);function gtm_consoleLog(a){if(typeof logPush==="undefined"){logPush=false}if(logPush==true){console.info(a)}}function productClick(b){if(typeof dataLayer!=="undefined"){var c="id";for(var a=0;a<dataLayer.length;a++){if(dataLayer[a].hasOwnProperty("ecommerce")&&typeof dataLayer[a].ecommerce!=="undefined"&&dataLayer[a].ecommerce.hasOwnProperty("impressions")){$.each(dataLayer[a].ecommerce.impressions,function(f,e){if(e.id==b&&Object.keys(this).length!=0){var d=getNewProductClickObject();d.ecommerce.click.products.push(this);dataLayer.push(d)}})}}}}function productDetail(b){if(typeof dataLayer!=="undefined"){var c="id";for(var a=0;a<dataLayer.length;a++){if(dataLayer[a].hasOwnProperty("ecommerce")&&typeof dataLayer[a].ecommerce!=="undefined"&&dataLayer[a].ecommerce.hasOwnProperty("impressions")){$.each(dataLayer[a].ecommerce.impressions,function(f,e){if(e.id==b&&Object.keys(this).length!=0){var d=getNewProductDetailObject();d.ecommerce.detail.products.push(this);dataLayer.push(d)}})}}}}function getNewProductDetailObject(){var a={event:"detailView",ecommerce:{detail:{products:[]}}};return a}function getNewProductClickObject(){var a={event:"productClick",ecommerce:{click:{products:[]}}};return a}function promoClick(a){if(typeof dataLayer!=="undefined"){sendToGtmEECPromo(a,"promoClick");dataLayer.push(gtmEECObjects.promoClick)}}window.addEventListener("DOMContentLoaded",function(){if(typeof dataLayer!=="undefined"){var a=$("[data-promo-analytics]");if(a.length>0){for(i=0;i<a.length;i++){sendToGtmEECPromo(a[i],"promoView")}dataLayer.push(gtmEECObjects.promoImpression)}}});var gtmEECObjects={promoImpression:{event:"promoImpressions",ecommerce:{promoView:{promotions:[]}}},promoClick:{event:"promotionClick",ecommerce:{promoClick:{promotions:[]}}},productClick:{event:"productClick",ecommerce:{click:{products:[]}}},productDetail:{event:"detailView",ecommerce:{detail:{products:[]}}}};function sendToGtmEECPromo(e,d){var b={id:"",name:"",creative:"",position:""};var c=e.getAttribute("data-promo-analytics");if(c===null||c.indexOf("|")==0){console.warn("promo-analytics attribute not found/invalid format.");return}var a=c.split("|");if(a.length!==4){console.warn("data-promo-analytics missing data");return}b.id=a[0];b.name=a[1];b.creative=a[2];b.position=a[3];switch(d){case"promoView":gtmEECObjects.promoImpression.ecommerce.promoView.promotions.push(b);break;case"promoClick":gtmEECObjects.promoClick.ecommerce.promoClick.promotions.length=0;gtmEECObjects.promoClick.ecommerce.promoClick.promotions.push(b);break}}function gtmEvent(a){var b=gtmClickEventData[a];if(typeof dataLayer!=="undefined"&&b!=="undefined"){dataLayer.push(b)}}function gtmClickEvent(a,b){gtm_consoleLog("*** Start gtmClickEvent() ***");var d=a.split("|");for(i=0;i<d.length;i++){var g=d[i].split("=");var c=g[0];var f=g[1];gtm_consoleLog("set "+c+" as "+f+" in "+b+" of globalClickEventData object");if(typeof globalClickEventData!=="undefined"){globalClickEventData[b][c]=f}}if(typeof dataLayer!=="undefined"&&globalClickEventData[b]!=="undefined"){var e=globalClickEventData[b];gtm_consoleLog("push to dataLayer");dataLayer.push(e)}gtm_consoleLog("*** End gtmClickEvent() ***")}globalClickEventData={clickToCall:{event:"gaTrackEvent-clickToCall",gaEventCategory:"Contact",gaEventAction:"Clicked Phone Number Link",gaEventLabel:""},phoneNumberType:{event:"gaTrackEvent-PhoneNumberType",gaEventCategory:"Phone number type",gaEventAction:"Click",gaEventLabel:""}};function gtmFormClickEvent(m,j,h){gtm_consoleLog("*** Start gtmFormClickEvent() ***");var k=j.split("|");for(i=0;i<k.length;i++){var b=k[i].split("=");var g=b[0];var n=b[1];gtm_consoleLog("Set value of form element:"+g+" of formid:"+m+" to gtmEventAttribute:"+n+" in gtmEvent:"+h+" of gtmClickEventData object");var c=false;var d=jQuery("#"+m+" input[name="+g+"]").attr("type");if(typeof d==="undefined"){d=jQuery("#"+m+" input[id="+g+"]").attr("type");c=true}gtm_consoleLog("formId: "+m+" element:"+g+" is type:"+d);var f="name";if(c){f="id"}var e="";if(d=="checkbox"||d=="radio"){gtm_consoleLog("considering it as radio/checkbox button");e=$("#"+m+" input["+f+"="+g+"]:checked").val()}if(typeof d==="undefined"||d=="text"){gtm_consoleLog("considering it as text");e=$("#"+m+" input["+f+"="+g+"]").val()}if(typeof gtmClickEventData!=="undefined"&&typeof e!=="undefined"){var a=e.replace(/([^a-z0-9_]+)/gi,"");gtm_consoleLog("Set value:"+a+" to gtmClickEventData."+h+"."+n);gtmClickEventData[h][n]=a}}if(typeof dataLayer!=="undefined"||gtmClickEventData!=="undefined"){var l=gtmClickEventData[h];gtm_consoleLog("push to dataLayer");dataLayer.push(l)}gtm_consoleLog("*** End gtmFormClickEvent() ***")}function omni_track(a){if(typeof dataLayer!=="undefined"){dataLayer.push({event:"omniTrackEvent",omniTrackEventParam:a})}};