(function(a){a.fn.gtwitter=function(f){var q=a.extend({username:null,avatar_size:null,count:5,loading_text:"Loading..",twitter_url:"twitter.com",twitter_api_url:"api.twitter.com",link_target:"_blank",template:"{avatar_linked} {text} {time_ago_linked}"},f),l=function(v){return parseInt(v,10)},p=function(v){return v.replace(/</g,"&lt;").replace(/>/g,"^&gt;")},u=function(v){return Date.parse(v.replace(/^([a-z]{3})( [a-z]{3} \d\d?)(.*)( \d{4})$/i,"$1,$2$4$3"))},m=/\b((?:https?:\/\/|www\d{0,3}[.]|[a-z0-9.\-]+[.][a-z]{2,4}\/)(?:[^\s()<>]+|\(([^\s()<>]+|(\([^\s()<>]+\)))*\))+(?:\(([^\s()<>]+|(\([^\s()<>]+\)))*\)|[^\s`!()\[\]{};:'".,<>?«»“”‘’]))/gi,b={},n,k,r,g,s,h;function t(w,v){if(typeof w==="string"){s=w;jQuery.each(v,function(x,y){s=s.split("{"+x+"}").join(y===null?"":y)});return s}else{return w(v)}}function c(){n=document.location.protocol==="https"?"https":"http";return t("{protocol}://{twitter_api_url}/1/statuses/user_timeline.json?screen_name={username}&count={count}",{protocol:n,twitter_api_url:q.twitter_api_url,username:q.username,count:q.count+1})}function o(v){return v.replace(m,function(w){g=(/^[a-z]+:/i).test(w)?w:"http://"+w;s=w;return t('<a href="{link_url}" target="{link_target}">{link_text}</a>',{link_url:p(g),link_target:q.link_target,link_text:p(s)})})}function i(v){k=new Date();r=l((k.getTime()-v)/1000);r=r<1?0:r;return{days:l(r/86400),hours:l(r/3600),minutes:l(r/60),seconds:l(r)}}function d(v){if(v.seconds<=1){return"just now."}else{if(v.seconds<60){return"about "+v.seconds+" seconds ago"}else{if(v.seconds<3600){return"about "+v.minutes+" minutes ago"}else{if(v.seconds<86400){return"about "+v.hours+" hours ago"}else{if(v.seconds>86400&&v.seconds<172800){return"about a day ago"}else{if(v.days<7){return"about "+v.days+" days ago"}else{return"ages ago."}}}}}}}function e(v){b={};b.username=v.user.name;b.avatar=t('<img class="avatar" src="{avatar_url}" width="{avatar_size}" height="{avatar_size}" />',{avatar_url:n==="https"?v.user.profile_image_url_https:v.user.profile_image_url,avatar_size:q.avatar_size||32}),b.avatar_linked=t('<a href="{protocol}://{twitter_url}/{username}" target="{link_target}">{avatar}</a>',{protocol:n,username:v.user.name,twitter_url:q.twitter_url,link_target:q.link_target,avatar:b.avatar});b.text=o(v.text);b.time_ago=d(i(u(v.created_at)));b.time_ago_linked=t('<div class="time_ago"><a href="{protocol}://{twitter_url}/username/status/{status_id}" target="{link_target}">{time_ago}</a></div>',{protocol:n,twitter_url:q.twitter_url,username:v.user.name,status_id:v.id_str,link_target:q.link_target,time_ago:b.time_ago});return b}function j(){h.append(jQuery("<p>").attr({className:"gtwitter-loading"}).html(q.loading_text));a.ajax({url:c(),dataType:"JSONP",crossDomain:true,success:function(v){h.empty();jQuery.each(v,function(w,x){h.append(jQuery("<li>").append(t(q.template,e(x))))})}})}return this.each(function(){h=a(this);j()})}})(jQuery);