var RegPath = RegPath || {};

extend(RegPath, {
    Pixel: {
        trackEvent: function (eventName, singleFire, engineName) {
            this.trackEventWithVariables(eventName, null, singleFire, engineName);
        },
        trackEventWithVariables: function (eventName, variables, singleFire, engineName) {

            if (singleFire && this.checkSingleFireEvents(eventName)) {
                return false;
            }

            if (!engineName)
                engineName = "GTM";

            switch (engineName) {
                case "GTM":
                default:
                    var dataLayerData = {};
                    if (variables != null) {
                        dataLayerData = variables;
                        dataLayerData.event = eventName;
                    }
                    else {
                        dataLayerData = { 'event': eventName };
                    }

                    console.debug('Firing GTM Event: ' + eventName);
                    dataLayer.push(dataLayerData);
                    break;
            }
        },
        checkSingleFireEvents: function (eventName) {
            var eventsFired = "";

            if ($.cookie("pixelEvents") != null) {
                eventsFired = $.cookie("pixelEvents");
                if (eventsFired.indexOf(eventName + ",") >= 0) {
                    // do not fire pixel, do not add event name to cookie
                    return true;
                }
            }

            $.cookie("pixelEvents",
                eventsFired + eventName + ",", {
                    expires: 1 // expire after 1 day
                });

            return false;
        }
    }
});
